<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Instagram Downloader — Download Karo</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header class="navbar">
    <a class="logo" href="/">Download Karo</a>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Instagram Downloader</h1>
      <p>Paste an Instagram post / reel URL and download the video or image.</p>
    </section>

    <div class="card" style="max-width:820px;margin:18px auto;padding:22px;">
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
        <input id="ig-url" class="big-input" placeholder="Paste Instagram post or reel URL (https://...)" />
        <button id="ig-fetch" class="btn">Fetch</button>
        <div id="ig-loader" class="loader" style="display:none"></div>
      </div>

      <div id="ig-result" style="margin-top:18px"></div>
    </div>

    <footer class="footer">© 2025 Download Karo • Made with ❤️ by Bunny</footer>
  </main>

  <script src="/script.js"></script>
  <script>
    const igFetch = qs('#ig-fetch');
    const igUrlInput = qs('#ig-url');
    const igResult = qs('#ig-result');
    const igLoader = qs('#ig-loader');

    igFetch.addEventListener('click', async ()=>{
      igResult.innerHTML = ''; igLoader.style.display = 'inline-block';
      const url = igUrlInput.value.trim();
      if(!url){ igResult.innerHTML = "<div style='color:#b91c1c'>Please enter a URL</div>"; igLoader.style.display='none'; return;}
      try{
        const r = await postJSON('/api/instagram',{url});
        const data = await r.json();
        igLoader.style.display = 'none';
        if(!r.ok){ igResult.innerHTML = `<div style='color:#b91c1c'>${data.error || 'Failed to fetch'}</div>`; return; }

        let html = `<h2 style="margin-top:8px">${data.title || data.caption || 'Instagram content'}</h2>`;
        if(data.thumbnail) html += `<img src="${data.thumbnail}" style="width:260px;border-radius:8px;margin-top:10px;">`;
        html += `<div style="margin-top:12px"><button class="btn" onclick="downloadViaProxy('${data.url}','instagram_media')">Download Video / Media</button></div>`;
        igResult.innerHTML = html;
      }catch(e){
        console.error(e);
        igLoader.style.display = 'none';
        igResult.innerHTML = "<div style='color:#b91c1c'>Unexpected error</div>";
      }
    });
  </script>
</body>
</html>
