<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Facebook Downloader — Download Karo</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header class="navbar">
    <a class="logo" href="/">Download Karo</a>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Facebook Downloader</h1>
      <p>Paste a Facebook post or video URL and fetch the media to download.</p>
    </section>

    <div class="card" style="max-width:820px;margin:18px auto;padding:22px;">
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
        <input id="fb-url" class="big-input" placeholder="Paste Facebook post or video URL (https://...)" />
        <button id="fb-fetch" class="btn">Fetch</button>
        <div id="fb-loader" class="loader" style="display:none"></div>
      </div>

      <div id="fb-result" style="margin-top:18px"></div>
    </div>

    <footer class="footer">© 2025 Download Karo • Made with ❤️ by Bunny</footer>
  </main>

  <script src="/script.js"></script>
  <script>
    const fbFetchBtn = qs('#fb-fetch');
    const fbUrlInput = qs('#fb-url');
    const fbResult = qs('#fb-result');
    const fbLoader = qs('#fb-loader');

    fbFetchBtn.addEventListener('click', async ()=>{
      fbResult.innerHTML=''; fbLoader.style.display='inline-block';
      const url = fbUrlInput.value.trim();
      if(!url){ fbResult.innerHTML = "<div style='color:#b91c1c'>Please enter a URL</div>"; fbLoader.style.display='none'; return; }
      try{
        const r = await postJSON('/api/facebook',{url});
        const data = await r.json();
        fbLoader.style.display='none';
        if(!r.ok){ fbResult.innerHTML = `<div style='color:#b91c1c'>${data.error || 'Failed to fetch'}</div>`; return; }

        let html = `<h2 style="margin-top:8px">${data.title || 'Facebook video'}</h2>`;
        if(data.thumbnail) html += `<img src="${data.thumbnail}" style="width:260px;border-radius:8px;margin-top:10px;">`;
        html += `<div style="margin-top:12px"><button class="btn" onclick="downloadViaProxy('${data.url}','facebook_media')">Download Video / Media</button></div>`;
        fbResult.innerHTML = html;
      }catch(e){
        console.error(e);
        fbLoader.style.display='none';
        fbResult.innerHTML = "<div style='color:#b91c1c'>Unexpected error</div>";
      }
    });
  </script>
</body>
</html>
